{"componentChunkName":"component---src-templates-blog-js","path":"/2022/05/07/play-with-jacoco/","result":{"data":{"blog":{"id":"3118c9dd-25ab-56e9-9905-a7ee7a70d6f1","html":"<p>最近在做一些代码的重构和基础库的迁移，这样的工作绝大部分时候不产生新的功能点，每次更换了类库后也都会将原来对应的测试同步迁移过来，保证新的代码和原来的代码一样工作。不过在迁移的过程中我发现 jacoco 所提示的代码覆盖率越来越低，让我很慌。为了搞明白这是啥原因，做了一些调研，这里把一些结论记录在这里加深印象，也便于后续查看。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 664px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/69c841087aeaddffca07b2e66e772a58/31493/screenshot-for-openbayes-server-code-converage-before.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABVklEQVQoz6WQ2UsCARDG/Vd7C3oIKuggKg3EjpcoTdO0zaMyuzYoegmLiAzsoCi0w/siK11BLXf3Fy5WvvvBMPPNMB/fjA4gl88jSRKqqqIoCmVJIl8o8P3d0Lgsy1oulcp8lkoar399oSgq9Xpd400093XVahXvmp8lhwvniptFmwOL1c7cvIV5sxXB7cNsteMP7HByeqb1HU6B7V0Rl+BhZdXLx8fnv2CzyGZz3N7dE316JhaPk0pnSKXTPEYihK9veI3FSSRTFIvv2jyRTPJWLBJPJMlkczQaMqraJtgpmqfLiqK9RSdVKuiNs/QPjzE0aqB3cISe4AR99yYGHmaw+ZeZHNdjmprGZDKwJ3ZzeNTFRcjYElPQ7LWgq9VqeNc3cQoefOt+bMsuhOsAvheRjdgBx+dBtja3EMV9RHGb0KWN8NUCkeju39/ao6OT1TZnvw5/AGgh9S3ToLQFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screenshot for openbayes server code converage before\"\n        title=\"screenshot for openbayes server code converage before\"\n        src=\"/static/69c841087aeaddffca07b2e66e772a58/31493/screenshot-for-openbayes-server-code-converage-before.png\"\n        srcset=\"/static/69c841087aeaddffca07b2e66e772a58/772e8/screenshot-for-openbayes-server-code-converage-before.png 200w,\n/static/69c841087aeaddffca07b2e66e772a58/e17e5/screenshot-for-openbayes-server-code-converage-before.png 400w,\n/static/69c841087aeaddffca07b2e66e772a58/31493/screenshot-for-openbayes-server-code-converage-before.png 664w\"\n        sizes=\"(max-width: 664px) 100vw, 664px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"代码测试覆盖率是什么意思\" style=\"position:relative;\">代码测试覆盖率是什么意思<a href=\"#%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95%E8%A6%86%E7%9B%96%E7%8E%87%E6%98%AF%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D\" aria-label=\"代码测试覆盖率是什么意思 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>在 <a href=\"https://www.baeldung.com/jacoco\">Intro to JaCoCo</a> 这里讲的非常明白了，代码测试覆盖率（或者说代码覆盖率）讲的是在跑测试的时候，到底有多少代码被执行了。按照粒度来分可以有以下几种：</p>\n<ol>\n<li><code>Line coverage</code> 按照字节码统计的多少 instruction 被执行了</li>\n<li><code>Branch converage</code> 按照 <code>if/else</code> <code>switch</code> 等分支统计多少分支被执行了</li>\n</ol>\n<p>由于代码确实会有很多防御性的 <code>if/else</code> 导致其实每一个分支并不是很对等，所以我个人感觉 <code>Line coverage</code> 会稍微好一些。</p>\n<p>不过要注意，测试覆盖率只反映你多少代码在测试的时候被执行了，执行了一次就算是执行了，但事实上不同的参数会导致不同的结果，很多边界条件是否被测试到也表现不出来。因此 100% 测试覆盖率不表示所有代码都是对的了。如何写测试本身是一件极其复杂的事情，有些编程思路如 TDD 都是围绕测试进行的，我也讲不明白。</p>\n<h2 id=\"是什么导致覆盖率越来越低\" style=\"position:relative;\">是什么导致覆盖率越来越低<a href=\"#%E6%98%AF%E4%BB%80%E4%B9%88%E5%AF%BC%E8%87%B4%E8%A6%86%E7%9B%96%E7%8E%87%E8%B6%8A%E6%9D%A5%E8%B6%8A%E4%BD%8E\" aria-label=\"是什么导致覆盖率越来越低 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>为了搞明白为什么我的测试覆盖率一降再降，我需要用 <a href=\"https://www.eclemma.org/jacoco/\">JaCoCo</a> 给我生成一下报告，我去看一下到底哪些地方的哪些代码测试出了问题。</p>\n<p>我的项目是用 <code>gradle</code> 管理的，执行如下命令重新跑一下测试并生成报告：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./gradlew cleanTest <span class=\"token builtin class-name\">test</span> jacocoTestReport</code></pre></div>\n<p>然后去项目目录 <code>build/reports/jacoco/test/html</code> 打开 <code>index.html</code> 看看情况，发现核心为题在于<strong>很多生成的代码</strong>被纳入了代码测试覆盖中。具体来讲有两个方面的内容：</p>\n<ol>\n<li>Lombok 生成的很多代码</li>\n<li>引入 QueryDSL 后其和对应的 <code>Entity</code> 生成的 <code>Q + Entity</code> 的名称的代码</li>\n</ol>\n<p>那问题就显而易见了，尤其是后者，每次迁移一个 JPA 的 Entity 类型就会对应生成一段 <code>Q + Entity</code> 的代码，这部分代码统统成了测试覆盖率的分母，覆盖率能不低么。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/14cb1429125421eb08b990822b166896/25e83/querydsl-generated-code-screenshot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACHElEQVQ4y42SiWocMRBE5/+/MQchib07o/s+54XROk4CtomgaEGjp66SttYHc56MMel9rDpe6hyT/1nneRJSXpwtOkHOiZQDIVlS8YTsiMWTSqCNQu2Z2gvn7JzneFMw4Rxs99vOvkue5Tdu5ifP+sb34zPf90/8OL7wJL+iwhOxCBiJORLnG5ojrrqlcmLDwLqMjx0bJtFXoo54FSj+mhBChTbOh8UP7G+lTaStKNcxvqNdQWtPFommKkEHlM3st0aOY+GuzN7TlutE2YZyDRMGUju0kkSTcSYhtcBoRVSOlNLrI7wLLO2y3JddFyohJGoojHa9XCGnRMmFNDK553f9XrBXyy52Qr5ytAvWYv/wi7yl370tlbnsXlNKqTjEQTSJvGfSnii24Jxj33eUUjhrcdEhkuQedkSUpJL+BUr7AAohOY6DqBP5yKQjUVzBWLOAWusFt8lxJMERBSppeu9/gKVOjG8rw+uAUpJkEjVWtNUIKbDWEkLAFIvL7p0sXoC1nSvDmMfjdmupvtJ0o5lGt51e+uoZYxY454xvAVU0plpsc5ReHo+S/5rwOnBNaZTBGYfVFiPNK+y67NovJ0bhglsupJZ471d/i3lymIr2jeMQ3Pc7Rhjc4bC7xTwbvPFI+chXKrn20iiEF9zNnZu+I50keM82xkmpg9YnpRRyyYw2mHm+6uwntdZl9aq9ddrs5OtvLhXqqMvyL2A4ji0m2rjOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"User 对应的 QUser 文件\"\n        title=\"User 对应的 QUser 文件\"\n        src=\"/static/14cb1429125421eb08b990822b166896/5a190/querydsl-generated-code-screenshot.png\"\n        srcset=\"/static/14cb1429125421eb08b990822b166896/772e8/querydsl-generated-code-screenshot.png 200w,\n/static/14cb1429125421eb08b990822b166896/e17e5/querydsl-generated-code-screenshot.png 400w,\n/static/14cb1429125421eb08b990822b166896/5a190/querydsl-generated-code-screenshot.png 800w,\n/static/14cb1429125421eb08b990822b166896/c1b63/querydsl-generated-code-screenshot.png 1200w,\n/static/14cb1429125421eb08b990822b166896/29007/querydsl-generated-code-screenshot.png 1600w,\n/static/14cb1429125421eb08b990822b166896/25e83/querydsl-generated-code-screenshot.png 2302w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">User 对应的 QUser 文件</figcaption>\n  </figure></p>\n<h2 id=\"如何改进\" style=\"position:relative;\">如何改进<a href=\"#%E5%A6%82%E4%BD%95%E6%94%B9%E8%BF%9B\" aria-label=\"如何改进 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>这部分的很多信息在 <a href=\"https://www.baeldung.com/jacoco-report-exclude\">Exclusions from Jacoco Report</a> 可以找到。</p>\n<h3 id=\"修改-jacoco-配置保证代码覆盖率统计的合理性\" style=\"position:relative;\">修改 JaCoCo 配置，保证代码覆盖率统计的合理性<a href=\"#%E4%BF%AE%E6%94%B9-jacoco-%E9%85%8D%E7%BD%AE%E4%BF%9D%E8%AF%81%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1%E7%9A%84%E5%90%88%E7%90%86%E6%80%A7\" aria-label=\"修改 jacoco 配置保证代码覆盖率统计的合理性 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>我们只需要测试自己写的代码，生成的代码不应纳入统计范围。这里直接粘贴下 <code>gradle</code> 里面 <code>jacocoTestReport</code> 的配置：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">jacocoTestReport {\n    // rule from https://bottom-to-top.tistory.com/36\n    // 过滤 QA-QZ 开头的所有类，对应了 querydsl 生成的 Q + Entity 的格式\n    def Qdomains = []\n    for(qPattern in \"**/QA\" .. \"**/QZ\"){\n        Qdomains.add(qPattern + \"*\")\n    }\n    afterEvaluate {\n        classDirectories.setFrom(files(classDirectories.files.collect {\n            fileTree(dir: it, exclude: [\n                    'com/openbayes/graphql/**',          // 所有 graphql 生成的代码\n                    'com/openbayes/application/data/**', // 所有的 DTO 所在的包\n                    'db/migration/**',                   // 所有的数据库 migration 代码\n                    '**/*Exception*',                    // 所有包含 Exception 的异常类\n                    '**/*Mixin*',                        // 所有 Jackson Mixin \n                    '**/*Command',                       // 所有带 Command 的类，也是 DTO\n            ] + Qdomains)\n        }))\n    }\n    reports {\n        csv.required = true\n    }\n}</code></pre></div>\n<p>可以看到，我这里主要是按照 <code>classDirectory</code> 对类进行了过滤，包括了以下内容：</p>\n<ol>\n<li>各种生成的代码：graphql 生成代码、querydsl 生成代码</li>\n<li>各种 DTO 和 Exception：<code>*Command</code> <code>data/**</code> 等</li>\n<li>实在不太好测试的东西，比如 migration 脚本、比如 Jackson 的 Mixin</li>\n</ol>\n<p>对 querydsl 这部分的过滤比较 tricky ，因为其默认生成的名字是 <code>Q + Entity</code>，本身过滤就有点难，如果采用 <code>**/Q*</code> 的形式会导致个别以 <code>Q</code> 开头但不是 querydsl 生成的类也被纳入过滤的范围，这里我采用的是 <a href=\"https://bottom-to-top.tistory.com/36\">https://bottom-to-top.tistory.com/36</a> 的方法，过滤掉由 <code>QA-QZ</code> 开头的所有的类。</p>\n<blockquote>\n<p>这里过滤 querydsl 的方法其实官方还有其他方案，但目前 <code>gradle</code> 这边支持不是很好，我目前用的 <code>querydsl</code> 版本为 5.0 有一些 PR 还没有纳入进来，后续如果官方有了更好支持会考虑做相应的调整。</p>\n</blockquote>\n<h3 id=\"通过注解过滤-lombok-的代码\" style=\"position:relative;\">通过注解过滤 Lombok 的代码<a href=\"#%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E8%BF%87%E6%BB%A4-lombok-%E7%9A%84%E4%BB%A3%E7%A0%81\" aria-label=\"通过注解过滤 lombok 的代码 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>JaCoCo 本身是考虑了要过滤掉生成的代码的，它提供了一个规则：</p>\n<blockquote>\n<p>Starting from JaCoCo 0.8.2, we can exclude classes and methods by annotating them with a custom annotation with the following properties:</p>\n<ul>\n<li>The name of the annotation should include Generated.</li>\n<li>The retention policy of annotation should be runtime or class.</li>\n</ul>\n</blockquote>\n<p>简单的翻一下，就是在 JaCoCo 0.8.2 后，通过提供一个带有 <code>Generated</code> 名称的 <code>RetentionPolicy</code> 为 <code>CLASS</code> 或者 <code>RUNTIME</code> 的注解，JaCoCo 会帮你自动过滤这些类。</p>\n<p>Lombok 也对这部分做了支持，只要提供一个配置 <code>lombok.config</code> 就能让 Lombok 给自己生成的代码添加上相应的注解了：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">lombok.addLombokGeneratedAnnotation = true</code></pre></div>\n<h2 id=\"最后\" style=\"position:relative;\">最后<a href=\"#%E6%9C%80%E5%90%8E\" aria-label=\"最后 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>在做了上述两方面的修改后，测试覆盖率重回 70% 了。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 686px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2996dcf11e841d2858f3f864fdfebfb5/f6386/openbayes-server-code-coverage-after.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABRklEQVQoz62RzUsCcRCG97/s0K1LCH1YER3SAkuIDhEUQdAtyMz8WtfVdXVTzE+kCCLt4i2CvjDQENzfPrGL7qVDHRp4mYFhnnmHkQBGoxF/Ccuyfu1J/X6fcCTqKCkrZDWdWEImENwhlzcolsrE4jJ6waBWb3BwdEwqnaHRbJFMpYlE4/R6ny5UGg6H3NzeEQpHiMaTVGp1ytUqMVlGyxc4O79woHmjSLvziKpp6IbBQ6dNwSii5w1shgvkH8IGmabAFAJpMPhCTmvEUyoJWeVSUQh3VSLPGvLrFaXWNVk1i6blyOoZlG6I1NMplZccpmk6EpblQB2Hb+8fzM4t41lYYXFpjRnvPJ6cD29zG//9Prsne2ys+wkEttgM+lgtTrPamuKw7be9/XiWe7IQwtlmCcvRaFw7vfF2e97OwjInLNfZxOE3Gony24nPymoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"openbayes server code coverage after\"\n        title=\"openbayes server code coverage after\"\n        src=\"/static/2996dcf11e841d2858f3f864fdfebfb5/f6386/openbayes-server-code-coverage-after.png\"\n        srcset=\"/static/2996dcf11e841d2858f3f864fdfebfb5/772e8/openbayes-server-code-coverage-after.png 200w,\n/static/2996dcf11e841d2858f3f864fdfebfb5/e17e5/openbayes-server-code-coverage-after.png 400w,\n/static/2996dcf11e841d2858f3f864fdfebfb5/f6386/openbayes-server-code-coverage-after.png 686w\"\n        sizes=\"(max-width: 686px) 100vw, 686px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95%E8%A6%86%E7%9B%96%E7%8E%87%E6%98%AF%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D\">代码测试覆盖率是什么意思</a></p>\n</li>\n<li>\n<p><a href=\"#%E6%98%AF%E4%BB%80%E4%B9%88%E5%AF%BC%E8%87%B4%E8%A6%86%E7%9B%96%E7%8E%87%E8%B6%8A%E6%9D%A5%E8%B6%8A%E4%BD%8E\">是什么导致覆盖率越来越低</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%A6%82%E4%BD%95%E6%94%B9%E8%BF%9B\">如何改进</a></p>\n<ul>\n<li><a href=\"#%E4%BF%AE%E6%94%B9-jacoco-%E9%85%8D%E7%BD%AE%E4%BF%9D%E8%AF%81%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1%E7%9A%84%E5%90%88%E7%90%86%E6%80%A7\">修改 JaCoCo 配置，保证代码覆盖率统计的合理性</a></li>\n<li><a href=\"#%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E8%BF%87%E6%BB%A4-lombok-%E7%9A%84%E4%BB%A3%E7%A0%81\">通过注解过滤 Lombok 的代码</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E6%9C%80%E5%90%8E\">最后</a></p>\n</li>\n</ul>","frontmatter":{"title":"配置 jacoco 以提供更合理的测试覆盖率","date":"May 07, 2022","tags":["java","jacoco"]},"excerpt":"最近在做一些代码的重构和基础库的迁移，这样的工作绝大部分时候不产生新的功能点，每次更换了类库后也都…"}},"pageContext":{"id":"3118c9dd-25ab-56e9-9905-a7ee7a70d6f1"}},"staticQueryHashes":["26522286"],"slicesMap":{}}