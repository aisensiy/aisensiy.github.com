{"componentChunkName":"component---src-templates-blog-js","path":"/autosize-textarea","result":{"data":{"blog":{"id":"81f04c4e-6a7f-5840-912b-797f4ef1b0fb","html":"<p>最近需要一个功能，要让 textarea 可以根据内容进行自动 resize 保证元素的高度不能低于目前填充内容的高度。这种需求似乎也挺广泛的了。比如 zhihu 的评论就应用了这样的体验。</p>\n<p>最近自己也需要这样的体验效果，于是 google 了下，迅速的找到了一个 jquery 的插件就 ok 了。不过我自己想了下，感觉自动的增加高度是可行的。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">elem.style.height = elem.scrollHeight + 'px';</code></pre></div>\n<p>似乎就可以解决问题。但是，如果我删除了一些文字，怎么能够让已经变高的文本框再变低呢。这个我没有想到什么解决办法。于是就去看了下人家的源码，发现这个功能做的非常的聪明。还是要利用 <code class=\"language-text\">scrollHeight</code>  这个东西来做。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">elem.style.height = 0; elem.style.height = elem.scrollHeight + 'px';</code></pre></div>\n<p>简单说明一下，把 <code class=\"language-text\">height</code> 设置为 0 之后，<code class=\"language-text\">scrollHeight</code> 的值就是真实的高度了。那么，把目前的高度设置成 <code class=\"language-text\">scrollHeight</code> 就 ok 了。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">auto_grow</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">elem</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> len <span class=\"token operator\">=</span> elem<span class=\"token punctuation\">.</span>len <span class=\"token operator\">||</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> h <span class=\"token operator\">=</span> elem<span class=\"token punctuation\">.</span>scrollHeight<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">!=</span> len<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    elem<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    elem<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> elem<span class=\"token punctuation\">.</span>scrollHeight <span class=\"token operator\">+</span> <span class=\"token string\">'px'</span><span class=\"token punctuation\">;</span>\n    elem<span class=\"token punctuation\">.</span>len <span class=\"token operator\">=</span> elem<span class=\"token punctuation\">.</span>scrollHeight<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'textarea'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keyup'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">auto_grow</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>那么就是这么简单。</p>","tableOfContents":"","frontmatter":{"title":"autosize textarea","date":"April 07, 2013"}}},"pageContext":{"id":"81f04c4e-6a7f-5840-912b-797f4ef1b0fb"}},"staticQueryHashes":[]}