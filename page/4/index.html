<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.75d49e09df517a488346.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

/*
! tailwindcss v3.0.7 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity))}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where([class~=lead]):not(:where([class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-bottom:1.2em;margin-top:1.2em}.prose :where(a):not(:where([class~=not-prose] *)){color:var(--tw-prose-links);font-weight:500;text-decoration:underline}.prose :where(strong):not(:where([class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(ol):not(:where([class~=not-prose] *)){list-style-type:decimal;padding-left:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose] *)){list-style-type:disc;padding-left:1.625em}.prose :where(ol>li):not(:where([class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(hr):not(:where([class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-bottom:3em;margin-top:3em}.prose :where(blockquote):not(:where([class~=not-prose] *)){border-left-color:var(--tw-prose-quote-borders);border-left-width:.25rem;color:var(--tw-prose-quotes);font-style:italic;font-weight:500;margin-bottom:1.6em;margin-top:1.6em;padding-left:1em;quotes:"\201C""\201D""\2018""\2019"}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-size:2.25em;font-weight:800;line-height:1.1111111;margin-bottom:.8888889em;margin-top:0}.prose :where(h1 strong):not(:where([class~=not-prose] *)){font-weight:900}.prose :where(h2):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.5em;font-weight:700;line-height:1.3333333;margin-bottom:1em;margin-top:2em}.prose :where(h2 strong):not(:where([class~=not-prose] *)){font-weight:800}.prose :where(h3):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.25em;font-weight:600;line-height:1.6;margin-bottom:.6em;margin-top:1.6em}.prose :where(h3 strong):not(:where([class~=not-prose] *)){font-weight:700}.prose :where(h4):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;line-height:1.5;margin-bottom:.5em;margin-top:1.5em}.prose :where(h4 strong):not(:where([class~=not-prose] *)){font-weight:700}.prose :where(figure>*):not(:where([class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(figcaption):not(:where([class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose :where(code):not(:where([class~=not-prose] *)){color:var(--tw-prose-code);font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose] *)){color:var(--tw-prose-links)}.prose :where(pre):not(:where([class~=not-prose] *)){background-color:var(--tw-prose-pre-bg);border-radius:.375rem;color:var(--tw-prose-pre-code);font-size:.875em;font-weight:400;line-height:1.7142857;margin-bottom:1.7142857em;margin-top:1.7142857em;overflow-x:auto;padding:.8571429em 1.1428571em}.prose :where(pre code):not(:where([class~=not-prose] *)){background-color:transparent;border-radius:0;border-width:0;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.prose :where(pre code):not(:where([class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose] *)){font-size:.875em;line-height:1.7142857;margin-bottom:2em;margin-top:2em;table-layout:auto;text-align:left;width:100%}.prose :where(thead):not(:where([class~=not-prose] *)){border-bottom-color:var(--tw-prose-th-borders);border-bottom-width:1px}.prose :where(thead th):not(:where([class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;padding-bottom:.5714286em;padding-left:.5714286em;padding-right:.5714286em;vertical-align:bottom}.prose :where(tbody tr):not(:where([class~=not-prose] *)){border-bottom-color:var(--tw-prose-td-borders);border-bottom-width:1px}.prose :where(tbody tr:last-child):not(:where([class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose] *)){padding:.5714286em;vertical-align:baseline}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:rgba(0,0,0,.5);--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(p):not(:where([class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where(img):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(video):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(figure):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(h2 code):not(:where([class~=not-prose] *)){font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose] *)){font-size:.9em}.prose :where(li):not(:where([class~=not-prose] *)){margin-bottom:.5em;margin-top:.5em}.prose :where(ol>li):not(:where([class~=not-prose] *)){padding-left:.375em}.prose :where(ul>li):not(:where([class~=not-prose] *)){padding-left:.375em}.prose>:where(ul>li p):not(:where([class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose>:where(ul>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.25em}.prose>:where(ul>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.25em}.prose>:where(ol>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.25em}.prose>:where(ol>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(hr+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose] *)){padding-left:0}.prose :where(thead th:last-child):not(:where([class~=not-prose] *)){padding-right:0}.prose :where(tbody td:first-child):not(:where([class~=not-prose] *)){padding-left:0}.prose :where(tbody td:last-child):not(:where([class~=not-prose] *)){padding-right:0}.prose>:where(:first-child):not(:where([class~=not-prose] *)){margin-top:0}.prose>:where(:last-child):not(:where([class~=not-prose] *)){margin-bottom:0}body{background-color:rgb(255 255 255/var(--tw-bg-opacity));transition-duration:.5s;transition-property:color,background-color,border-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.dark body,body{--tw-bg-opacity:1}.dark body{background-color:rgb(55 65 81/var(--tw-bg-opacity))}.main .permalink{fill:currentColor;--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.dark .main .permalink{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.main{color:rgb(31 41 55/var(--tw-text-opacity))}.dark .main,.main{--tw-text-opacity:1}.dark .main{color:rgb(229 231 235/var(--tw-text-opacity))}.main h1{font-size:1.875rem;font-weight:800;letter-spacing:-.025em;line-height:2.25rem;margin-bottom:1rem;margin-top:2rem}@media (min-width:768px){.main h1{font-size:2.25rem;line-height:2.5rem}}@media (min-width:1280px){.main h1{font-size:3rem;line-height:1}}.main h2{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity));margin-bottom:1rem}.dark .main h2{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.main{overflow-wrap:break-word}.table-of-content ol,.table-of-content ul{margin-bottom:1rem;margin-left:1rem}.table-of-content ul{list-style-type:disc}.table-of-content ol{list-style-position:inside;list-style-type:decimal}.table-of-content{--tw-border-opacity:1;--tw-bg-opacity:1;background-color:rgb(191 219 254/var(--tw-bg-opacity));border-color:rgb(59 130 246/var(--tw-border-opacity));border-width:1px;display:inline-block;margin-bottom:1rem;margin-top:1rem;overflow:auto;padding:1rem}.dark .table-of-content{--tw-border-opacity:1;--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity));border-color:rgb(30 64 175/var(--tw-border-opacity))}.table-of-content a{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.table-of-content a:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.dark .table-of-content a{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.table-of-content ul{margin-bottom:0}.table-of-content h2{font-size:1.25rem;font-weight:600;letter-spacing:-.025em;line-height:1.75rem;margin-bottom:.75rem;margin-top:.75rem}.table-of-content p{display:inline;margin:0}.gatsby-highlight-code-line{--tw-bg-opacity:1!important;background-color:rgb(55 65 81/var(--tw-bg-opacity))!important}.bottom-0{bottom:0}.m-0{margin:0}.mx-auto{margin-left:auto;margin-right:auto}.mx-12{margin-left:3rem;margin-right:3rem}.my-4{margin-bottom:1rem;margin-top:1rem}.mx-4{margin-left:1rem;margin-right:1rem}.mt-8{margin-top:2rem}.mb-4{margin-bottom:1rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.h-5{height:1.25rem}.w-5{width:1.25rem}.w-32{width:8rem}.max-w-none{max-width:none}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.list-decimal{list-style-type:decimal}.flex-row{flex-direction:row}.justify-center{justify-content:center}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(2rem*var(--tw-space-y-reverse));margin-top:calc(2rem*(1 - var(--tw-space-y-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.overflow-auto{overflow:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.border{border-width:1px}.border-solid{border-style:solid}.border-gray-800{--tw-border-opacity:1;border-color:rgb(31 41 55/var(--tw-border-opacity))}.border-blue-500{--tw-border-opacity:1;border-color:rgb(59 130 246/var(--tw-border-opacity))}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-blue-200{--tw-bg-opacity:1;background-color:rgb(191 219 254/var(--tw-bg-opacity))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.fill-current{fill:currentColor}.p-4{padding:1rem}.py-12{padding-bottom:3rem;padding-top:3rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.text-center{text-align:center}.font-serif{font-family:ui-serif,Georgia,Cambria,Times New Roman,Times,serif}.text-6xl{font-size:3.75rem;line-height:1}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-extrabold{font-weight:800}.font-semibold{font-weight:600}.leading-7{line-height:1.75rem}.tracking-tight{letter-spacing:-.025em}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity))}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.hover\:underline:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.dark .dark\:prose-dark{color:#d1d5db}.dark .dark\:prose-dark :where([class~=lead]):not(:where([class~=not-prose] *)){color:#9ca3af}.dark .dark\:prose-dark :where(a):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(strong):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(ul>li):not(:where([class~=not-prose] *)):before{background-color:#374151}.dark .dark\:prose-dark :where(hr):not(:where([class~=not-prose] *)){border-color:#1f2937}.dark .dark\:prose-dark :where(blockquote):not(:where([class~=not-prose] *)){border-left-color:#1f2937;color:#f3f4f6}.dark .dark\:prose-dark :where(h1):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(h2):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(h3):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(h4):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(code):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(a code):not(:where([class~=not-prose] *)){color:#f3f4f6}.dark .dark\:prose-dark :where(pre):not(:where([class~=not-prose] *)){background-color:#1f2937;color:#e5e7eb}.dark .dark\:prose-dark :where(thead):not(:where([class~=not-prose] *)){border-bottom-color:#374151;color:#f3f4f6}.dark .dark\:prose-dark :where(tbody tr):not(:where([class~=not-prose] *)){border-bottom-color:#1f2937}.dark .dark\:border-blue-800{--tw-border-opacity:1;border-color:rgb(30 64 175/var(--tw-border-opacity))}.dark .dark\:bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.dark .dark\:text-gray-200{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}@media (min-width:768px){.md\:fixed{position:fixed}.md\:absolute{position:absolute}.md\:ml-80{margin-left:20rem}.md\:h-full{height:100%}.md\:w-80{width:20rem}.md\:max-w-6xl{max-width:72rem}.md\:p-8{padding:2rem}.md\:text-left{text-align:left}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}@media (min-width:1024px){.lg\:prose-lg{font-size:1.125rem;line-height:1.7777778}.lg\:prose-lg :where(p):not(:where([class~=not-prose] *)){margin-bottom:1.3333333em;margin-top:1.3333333em}.lg\:prose-lg :where([class~=lead]):not(:where([class~=not-prose] *)){font-size:1.2222222em;line-height:1.4545455;margin-bottom:1.0909091em;margin-top:1.0909091em}.lg\:prose-lg :where(blockquote):not(:where([class~=not-prose] *)){margin-bottom:1.6666667em;margin-top:1.6666667em;padding-left:1em}.lg\:prose-lg :where(h1):not(:where([class~=not-prose] *)){font-size:2.6666667em;line-height:1;margin-bottom:.8333333em;margin-top:0}.lg\:prose-lg :where(h2):not(:where([class~=not-prose] *)){font-size:1.6666667em;line-height:1.3333333;margin-bottom:1.0666667em;margin-top:1.8666667em}.lg\:prose-lg :where(h3):not(:where([class~=not-prose] *)){font-size:1.3333333em;line-height:1.5;margin-bottom:.6666667em;margin-top:1.6666667em}.lg\:prose-lg :where(h4):not(:where([class~=not-prose] *)){line-height:1.5555556;margin-bottom:.4444444em;margin-top:1.7777778em}.lg\:prose-lg :where(img):not(:where([class~=not-prose] *)){margin-bottom:1.7777778em;margin-top:1.7777778em}.lg\:prose-lg :where(video):not(:where([class~=not-prose] *)){margin-bottom:1.7777778em;margin-top:1.7777778em}.lg\:prose-lg :where(figure):not(:where([class~=not-prose] *)){margin-bottom:1.7777778em;margin-top:1.7777778em}.lg\:prose-lg :where(figure>*):not(:where([class~=not-prose] *)){margin-bottom:0;margin-top:0}.lg\:prose-lg :where(figcaption):not(:where([class~=not-prose] *)){font-size:.8888889em;line-height:1.5;margin-top:1em}.lg\:prose-lg :where(code):not(:where([class~=not-prose] *)){font-size:.8888889em}.lg\:prose-lg :where(h2 code):not(:where([class~=not-prose] *)){font-size:.8666667em}.lg\:prose-lg :where(h3 code):not(:where([class~=not-prose] *)){font-size:.875em}.lg\:prose-lg :where(pre):not(:where([class~=not-prose] *)){border-radius:.375rem;font-size:.8888889em;line-height:1.75;margin-bottom:2em;margin-top:2em;padding:1em 1.5em}.lg\:prose-lg :where(ol):not(:where([class~=not-prose] *)){padding-left:1.5555556em}.lg\:prose-lg :where(ul):not(:where([class~=not-prose] *)){padding-left:1.5555556em}.lg\:prose-lg :where(li):not(:where([class~=not-prose] *)){margin-bottom:.6666667em;margin-top:.6666667em}.lg\:prose-lg :where(ol>li):not(:where([class~=not-prose] *)){padding-left:.4444444em}.lg\:prose-lg :where(ul>li):not(:where([class~=not-prose] *)){padding-left:.4444444em}.lg\:prose-lg>:where(ul>li p):not(:where([class~=not-prose] *)){margin-bottom:.8888889em;margin-top:.8888889em}.lg\:prose-lg>:where(ul>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.3333333em}.lg\:prose-lg>:where(ul>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.3333333em}.lg\:prose-lg>:where(ol>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.3333333em}.lg\:prose-lg>:where(ol>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.3333333em}.lg\:prose-lg :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose] *)){margin-bottom:.8888889em;margin-top:.8888889em}.lg\:prose-lg :where(hr):not(:where([class~=not-prose] *)){margin-bottom:3.1111111em;margin-top:3.1111111em}.lg\:prose-lg :where(hr+*):not(:where([class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(h2+*):not(:where([class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(h3+*):not(:where([class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(h4+*):not(:where([class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(table):not(:where([class~=not-prose] *)){font-size:.8888889em;line-height:1.5}.lg\:prose-lg :where(thead th):not(:where([class~=not-prose] *)){padding-bottom:.75em;padding-left:.75em;padding-right:.75em}.lg\:prose-lg :where(thead th:first-child):not(:where([class~=not-prose] *)){padding-left:0}.lg\:prose-lg :where(thead th:last-child):not(:where([class~=not-prose] *)){padding-right:0}.lg\:prose-lg :where(tbody td):not(:where([class~=not-prose] *)){padding:.75em}.lg\:prose-lg :where(tbody td:first-child):not(:where([class~=not-prose] *)){padding-left:0}.lg\:prose-lg :where(tbody td:last-child):not(:where([class~=not-prose] *)){padding-right:0}.lg\:prose-lg>:where(:first-child):not(:where([class~=not-prose] *)){margin-top:0}.lg\:prose-lg>:where(:last-child):not(:where([class~=not-prose] *)){margin-bottom:0}}@media (min-width:1280px){.xl\:prose-xl{font-size:1.25rem;line-height:1.8}.xl\:prose-xl :where(p):not(:where([class~=not-prose] *)){margin-bottom:1.2em;margin-top:1.2em}.xl\:prose-xl :where([class~=lead]):not(:where([class~=not-prose] *)){font-size:1.2em;line-height:1.5;margin-bottom:1em;margin-top:1em}.xl\:prose-xl :where(blockquote):not(:where([class~=not-prose] *)){margin-bottom:1.6em;margin-top:1.6em;padding-left:1.0666667em}.xl\:prose-xl :where(h1):not(:where([class~=not-prose] *)){font-size:2.8em;line-height:1;margin-bottom:.8571429em;margin-top:0}.xl\:prose-xl :where(h2):not(:where([class~=not-prose] *)){font-size:1.8em;line-height:1.1111111;margin-bottom:.8888889em;margin-top:1.5555556em}.xl\:prose-xl :where(h3):not(:where([class~=not-prose] *)){font-size:1.5em;line-height:1.3333333;margin-bottom:.6666667em;margin-top:1.6em}.xl\:prose-xl :where(h4):not(:where([class~=not-prose] *)){line-height:1.6;margin-bottom:.6em;margin-top:1.8em}.xl\:prose-xl :where(img):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.xl\:prose-xl :where(video):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.xl\:prose-xl :where(figure):not(:where([class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.xl\:prose-xl :where(figure>*):not(:where([class~=not-prose] *)){margin-bottom:0;margin-top:0}.xl\:prose-xl :where(figcaption):not(:where([class~=not-prose] *)){font-size:.9em;line-height:1.5555556;margin-top:1em}.xl\:prose-xl :where(code):not(:where([class~=not-prose] *)){font-size:.9em}.xl\:prose-xl :where(h2 code):not(:where([class~=not-prose] *)){font-size:.8611111em}.xl\:prose-xl :where(h3 code):not(:where([class~=not-prose] *)){font-size:.9em}.xl\:prose-xl :where(pre):not(:where([class~=not-prose] *)){border-radius:.5rem;font-size:.9em;line-height:1.7777778;margin-bottom:2em;margin-top:2em;padding:1.1111111em 1.3333333em}.xl\:prose-xl :where(ol):not(:where([class~=not-prose] *)){padding-left:1.6em}.xl\:prose-xl :where(ul):not(:where([class~=not-prose] *)){padding-left:1.6em}.xl\:prose-xl :where(li):not(:where([class~=not-prose] *)){margin-bottom:.6em;margin-top:.6em}.xl\:prose-xl :where(ol>li):not(:where([class~=not-prose] *)){padding-left:.4em}.xl\:prose-xl :where(ul>li):not(:where([class~=not-prose] *)){padding-left:.4em}.xl\:prose-xl>:where(ul>li p):not(:where([class~=not-prose] *)){margin-bottom:.8em;margin-top:.8em}.xl\:prose-xl>:where(ul>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.2em}.xl\:prose-xl>:where(ul>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.2em}.xl\:prose-xl>:where(ol>li>:first-child):not(:where([class~=not-prose] *)){margin-top:1.2em}.xl\:prose-xl>:where(ol>li>:last-child):not(:where([class~=not-prose] *)){margin-bottom:1.2em}.xl\:prose-xl :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose] *)){margin-bottom:.8em;margin-top:.8em}.xl\:prose-xl :where(hr):not(:where([class~=not-prose] *)){margin-bottom:2.8em;margin-top:2.8em}.xl\:prose-xl :where(hr+*):not(:where([class~=not-prose] *)){margin-top:0}.xl\:prose-xl :where(h2+*):not(:where([class~=not-prose] *)){margin-top:0}.xl\:prose-xl :where(h3+*):not(:where([class~=not-prose] *)){margin-top:0}.xl\:prose-xl :where(h4+*):not(:where([class~=not-prose] *)){margin-top:0}.xl\:prose-xl :where(table):not(:where([class~=not-prose] *)){font-size:.9em;line-height:1.5555556}.xl\:prose-xl :where(thead th):not(:where([class~=not-prose] *)){padding-bottom:.8888889em;padding-left:.6666667em;padding-right:.6666667em}.xl\:prose-xl :where(thead th:first-child):not(:where([class~=not-prose] *)){padding-left:0}.xl\:prose-xl :where(thead th:last-child):not(:where([class~=not-prose] *)){padding-right:0}.xl\:prose-xl :where(tbody td):not(:where([class~=not-prose] *)){padding:.8888889em .6666667em}.xl\:prose-xl :where(tbody td:first-child):not(:where([class~=not-prose] *)){padding-left:0}.xl\:prose-xl :where(tbody td:last-child):not(:where([class~=not-prose] *)){padding-right:0}.xl\:prose-xl>:where(:first-child):not(:where([class~=not-prose] *)){margin-top:0}.xl\:prose-xl>:where(:last-child):not(:where([class~=not-prose] *)){margin-bottom:0}.xl\:text-5xl{font-size:3rem;line-height:1}}</style><meta name="generator" content="Gatsby 4.3.0"/><title data-react-helmet="true">eisen-s-blog</title><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><style type="text/css">
    .custom-class.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .custom-class.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .custom-class svg,
    h2 .custom-class svg,
    h3 .custom-class svg,
    h4 .custom-class svg,
    h5 .custom-class svg,
    h6 .custom-class svg {
      visibility: hidden;
    }
    h1:hover .custom-class svg,
    h2:hover .custom-class svg,
    h3:hover .custom-class svg,
    h4:hover .custom-class svg,
    h5:hover .custom-class svg,
    h6:hover .custom-class svg,
    h1 .custom-class:focus svg,
    h2 .custom-class:focus svg,
    h3 .custom-class:focus svg,
    h4 .custom-class:focus svg,
    h5 .custom-class:focus svg,
    h6 .custom-class:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 100)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://plausible.io"/><script async="" defer="" data-domain="aisensiy.me" src="https://plausible.io/js/plausible.js"></script><script>
          window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) };
          
          </script><link as="script" rel="preload" href="/webpack-runtime-18a31e4fa83bf1e38b67.js"/><link as="script" rel="preload" href="/framework-45ca7a0c983b0b7a000c.js"/><link as="script" rel="preload" href="/app-301092c0672bcce1568f.js"/><link as="script" rel="preload" href="/75ce8a9e25edca21eb9c1a1dab0250d3ee550bef-e9b300a9f21137291b3a.js"/><link as="script" rel="preload" href="/component---src-templates-blogs-js-57b56258f6f79ef8dfb6.js"/><link as="fetch" rel="preload" href="/page-data/page/4/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="md:text-left text-center md:fixed md:w-80 bg-gray-900 md:h-full text-white"><div class="p-4 mx-auto text-center"><button aria-label="Activate Light Mode" title="Activate Light Mode" class="text-center"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" role="img"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg></button></div><div class="md:absolute bottom-0 py-12 mx-12 space-y-8"><h1 class="text-6xl font-black font-serif">Eisen&#x27;s Blog</h1><nav><ul class="text-md flex-row"><li><a class="leading-7 block hover:underline" href="/">Home</a></li><li><a class="leading-7 block hover:underline" href="/about">About</a></li><li><a class="leading-7 block hover:underline" href="/archive">Archive</a></li><li><a href="https://github.com/aisensiy" target="_blank" rel="noreferrer" class="leading-7 block hover:underline">GitHub</a></li></ul></nav><footer class="text-gray-400">© <!-- -->2022<!-- -->. All rights reserved.</footer></div></div><div class="md:ml-80 p-4 md:p-8 md:max-w-6xl main"><div><div><h1><a href="/ddd-and-cqrs-updated">对 CQRS 和 DDD 的一些新的讨论</a></h1><h2>2021 October-18</h2><div class="prose dark:prose-dark max-w-none lg:prose-lg xl:prose-xl"><p>在 <a href="/some-tips-for-ddd">some tips for ddd</a> 里讲明白了 DDD 是针对 <code>写模型</code> 的，而对于 <code>读模型</code> 则可以通过一层薄薄的 <code>Query Service</code> 直接从数据库拼装 <code>DTO</code> 实现，这样子的好处是：</p>
<ol>
<li>遵守了 DDD 中 <code>aggregate</code> 的访问原则 / 持久化原则，不会因为一个「展示包含用户头像的文章列表」而被轻易的破坏</li>
<li>减少了在 <code>读模型</code> 里 <code>DTO</code> 从 DDD 的 <code>Repository</code> 里各种转换和拼接，也避免了在 <code>Repository</code> 里面提供分页之类的奇怪方法</li>
</ol>
<p>在一个简单的项目 <a href="/real-world-spring-boot-and-mybatis">Spring Boot + Spring MVC + MyBatis 版本的 Real World 实现</a> 里，这个思路也得到了充分的体现。并且在这个过程中没有遇到什么冲突的地方。</p>
<p>不过最近一两年做的 openbayes 项目里，我发现 cqrs 的原则依然遇到了一些和 DDD 相冲突的地方，这里我</p>
<ol>
<li>首先记录一些最近补充学习的一些与该主题相关的资料，一方面确认之前的理解没有严重的偏差，另一方面引入一些相关的讨论</li>
<li>然后结合具体的业务去描述遇到的问题</li>
<li>至于能否解决后面再说...</li>
</ol>
<h2 id="有关-ddd--cqrs-的一些资料更新" style="position:relative;">有关 ddd / cqrs 的一些资料更新<a href="#%E6%9C%89%E5%85%B3-ddd--cqrs-%E7%9A%84%E4%B8%80%E4%BA%9B%E8%B5%84%E6%96%99%E6%9B%B4%E6%96%B0" aria-label="有关 ddd  cqrs 的一些资料更新 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>首先就是我最近看的一些内容。看了很多内容，包括 Martin Folwer 的一些链接，感觉最终将的比较清楚的还是 greg young 的内容。</p>
<p>CQRS 是由 greg young 提出的，他有一篇名为 <a href="https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf">CQRS Documents by Greg Young</a> 的资料比较详尽的探讨了 CQRS 和 event-sourcing 到底要解决什么样子的问题。开篇提出在我们所构建的系统不再是 CRUD 之后，可以引入 <code>Command</code> 的概念，描述 <code>Task Based User Interface</code>。而在处理这些 <code>Command</code> 的时候，会发现读和写流程处理会有非常大的区别，并且如果采用同一套 Domain Object 会引入如下问题：</p>
<ol>
<li>Large numbers of read methods on repositories often also including paging or sorting information. 在 Repository 中有大量的读操作需要包含分页 / 排序相关的功能。</li>
<li>Getters exposing the internal state of domain objects in order to build DTOs. 为了组装 <code>DTO</code> 不得不暴露很多 <code>Domain Object</code> 的内部状态。</li>
<li>Use of prefetch paths on the read use cases as they require more data to be loaded by the ORM. 由于读模型需要更多的数据，所以需要在 ORM 中组织额外的数据加载。</li>
<li>Loading of multiple aggregates to build a DTO causes non-optimal querying to the data model. Alternatively aggregate boundaries can be confused because of the DTO building operations. 在组装 <code>DTO</code> 时，为了获取多个聚合会容易出现低效的查询语句。另外，组装聚合的边界也会因为 <code>DTO</code> 的组装而被打破。</li>
</ol>
<p>可以看到要解决的痛点和我之前的理解没有什么偏差。</p>
<p>通过分别对读写构建独立的流程可以很好的缓解以上问题：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 717px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e9a9cc44447e8fcdd59bf9592cf1796a/0ad97/2021-10-18-15-24-35.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADcklEQVQ4y1WT/U9aZxTH/bf2W39Yqkk7m21dmmwze++2NFmp2Uuj1pdVp02rtZpKtZkube22OufiRK2AL2BFBAEBC3i5eC0WpICiqIBw+SxcfJknOc998uT5fu/5nu95SvL5PHvb2+wmEkpm93fZiUUQPW4CKz4Ej5eVlx5WBT8rHg+S4CO8FiC3v0s6uaNgkltbZFIpClEiyzJbkQibGxvEw2G8ngBzZjdTMxZEr4/NdYl4UCIWlIhIIi6HG/20BavdhyhIJCIbxEMh9pPJIiH/i2Bsj/catVy4qVey5pGVP40Sz2Yl1KNenkyJ1PXbKP9Zz/l6LaqeeTK5/DG+oLaksORkWTmQwgku/aLlk1YDHzRN8uNDEz0aNx1DS9Q/XuDuoB2V+gXv1E3w7k0dl9sNJPfSClaWi8QKYSFy2SyB13HUw0t0DNr5bczFoGEFcT0O+exxFbHtFHZ/VMnI5t6p6o4Ji+w5zJ4QFbf11D9aoHPIwaVmHW2DS+RzBzzUuGj7y07XsJPuERfdI27U/zq5M2A7JpaPJBciupXkyYSXlqcW7hWAQw5lf3/IyQtnkMouA+W1Y1S0TFDR8lz5XmwYp/yGRmnVkeySI+0Of4TSKg2f3pnk245pvm6f5ErnNBfqx6nuM7EkRpl1b2ATosreGYhh98dYFKLsp7MnpsiHFYZiSUVSY7+Fxn4zNX1zXFMb+KptmkGDcNLDxD6+4CY24Q3znjAOf5RcTj7tsjLcqQPUI8t82W7ko1vTvN80ycWmKcob9NwecOB7Fedyu5FztVrO1+kordFytlrLW5UaGh5bDwk5kSwE45RVj1NWO0nZDT2lNXrertJy5qdRWv6wMW5Z5VztBGdrdApRecOU8sMv7hoYW1g7MaVA6A8lcK3GGZgRqO5boKnfyvVeMwMzfpxi9Fiuf32T55Y1hmb9XOmc4f4/S2jmA5iWQ/hfF40pSWWyfN46xce3tKjURj5s0dE76qL5qQXvq3hxRg9V6BaDdPztUObym3tGPmstGnjmh2G6R14WCQsNNXvCGF3raK0SIyYRh7BB67NFrN4wmYMsO7tp8rLMhEVSBj+dOWB5NYZTfMNqOIEYShDfSZ1+KQVA8+82KrvNfN9jpvKBiatqE991zVHVO49KPYdKbeJa4bzLpNy5/quZ7d30qbf8H75E802xZGRHAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Separated Data Models with CQRS"
        title="Separated Data Models with CQRS"
        src="/static/e9a9cc44447e8fcdd59bf9592cf1796a/0ad97/2021-10-18-15-24-35.png"
        srcset="/static/e9a9cc44447e8fcdd59bf9592cf1796a/772e8/2021-10-18-15-24-35.png 200w,
/static/e9a9cc44447e8fcdd59bf9592cf1796a/e17e5/2021-10-18-15-24-35.png 400w,
/static/e9a9cc44447e8fcdd59bf9592cf1796a/0ad97/2021-10-18-15-24-35.png 717w"
        sizes="(max-width: 717px) 100vw, 717px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span>
    <figcaption class="gatsby-resp-image-figcaption">Separated Data Models with CQRS</figcaption>
  </figure></p>
<p>后续有关 event-sourcing 的内容就不再介绍了，我个人认为 event-sourcing 有关 data storage 的修改过于复杂，但其思想（比如采用反向的 Domain Event）确实已经被很好的采用了（openbayes 在子系统之间做数据同步也采用了类似的理念）。这部分以后单独讨论。</p>
<p>另外我看到了大神的 <a href="https://time.geekbang.org/column/intro/100082101">如何落地业务建模</a> 虽然没有明确的指出 CQRS 的问题，但却在「跨越现实的障碍」章节提出了类似于</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">user.getSubscriptions().subList(from, from + pageSize)</code></pre></div>
<p>的思路，描述的是一种统一的模型，而不是读写分离的模型。这的确是一个非常好的思路，通过依赖注入一个 <code>Query Service</code> 到具体的 <code>Domain Object</code> 可以很好的解决读写用例放在一起不协调的问题。这也让我开始重新思考 CQRS 是不是有一些问题。</p>
<h2 id="cqrs-遇到的问题" style="position:relative;">CQRS 遇到的问题<a href="#cqrs-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="cqrs 遇到的问题 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>首先，我觉得最大的问题就在于 CQRS 一定程度上让 <code>读模型</code> 成了二等公民。<code>写模型</code> 很重要，需要很仔细的遵循设计思路，而 <code>读模型</code> 就随便糊弄糊弄就完事了...</p>
<p>然后，其实 <code>读模型</code> 很多时候也不是纯粹的获取 <code>DTO</code> 做拼接就完事了。在涉及到权限的时候，DTO 也需要依据当前用户对数据做裁剪并依据对应的权限以及当前对象的状态补充对应的权限属性。</p>
<p>举一个例子，在 openbayes 里有一个 <code>Job</code> 的概念，它有自身的状态（<code>CREATED</code> <code>RUNNING</code> <code>CANCELLING</code> ...），并且对应着一个状态机。在 <code>GET /jobs/{jobid}</code> 时，不同的状态下会返回对应的 <code>links</code> 表明当前用户可以对该 <code>Job</code> 做什么样子的操作。比如处于 <code>RUNNING</code> 状态的 <code>Job</code> 对于有权限的用户应该有如下的 <code>links</code>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
  ...
  links: {
    "stop": "&lt;link>",
    "create-snapshot": "&lt;link>",
    "open": "&lt;link>"
  }
}</code></pre></div>
<p>这些 <code>links</code> 会为前端提供线索用于展示不同的交互 UI。</p>
<p>也就是说，从数据库里拿出来的 <code>DTO</code> 依然需要走一轮业务支持才能使用，没有想象中的那么傻瓜。并且有关状态机的逻辑已经在对应的 <code>Domain Object</code> 中写了一遍了，但是在返回对应的 JSON 数据的 REST 层依然存在大量的代码用于处理这些内容。</p>
<h2 id="可能的解决方案" style="position:relative;">可能的解决方案<a href="#%E5%8F%AF%E8%83%BD%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-label="可能的解决方案 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<h3 id="合并模型" style="position:relative;">合并模型<a href="#%E5%90%88%E5%B9%B6%E6%A8%A1%E5%9E%8B" aria-label="合并模型 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>第一个方案自然是不再做 CQRS 了，而应该统一模型，按照 <a href="https://time.geekbang.org/column/intro/100082101">如何落地业务建模</a> 的思路将两个模型的内容引入到同一个模型中去。不过这似乎是一个工作量不小的事情，很少有人会下定决心这么去做的，以及目前没有很健全的例子，需要先做小规模尝试，最终一定会花更多的时间...</p>
<p>不过不得不说 GraphQL 的引入似乎是一个很好的契机。</p>
<p>GraphQL 强调整个暴露的 API 是一张大图，而具体的属性的获取是一个渐进的过程。还是用 Real World 项目举例：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
  user(id: "eisenxu") {
    articles {
      id
      title
      content
      comments {
        id
        content
        author {
          id
          name
        }
      }
    }
  }
}</code></pre></div>
<p>这里是一个比较复杂的查询，获取了一个用户的文章列表以及每一篇文章的下的评论，以及每一篇评论的作者。对应的代码大概会是这个样子：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">class ArticleDatafetcher {
  public List&lt;Article> fetchArticles(User user) {
    return user.getArticles();
  }
}

class CommentDatafetcher {
  public List&lt;Comment> fetchComments(Article article) {
    return article.getComments();
  }
}

class UserDatafetcher {
  public User fetchUser(User user) {
    return user;
  }

  public User fetchCommentAuthor(Comment comment) {
    return comment.getAuthor();
  }
}</code></pre></div>
<p>每一个 <code>Entity</code> 或者 <code>Entity</code> 集合属性的获取都会对应一个 <code>上文</code> 也就是它是从那里获取的：</p>
<ul>
<li>user(id: 'eisenxu'): <code>上文</code> 为默认的 <code>Query</code></li>
<li>articles: <code>上文</code> 为 <code>user</code></li>
<li>comments: <code>上文</code> 为 <code>article</code></li>
<li>author: <code>上文</code> 为 <code>comment</code>（当然也会有 <code>上文</code> 为 <code>article</code> 的 <code>author</code>）</li>
</ul>
<p>如果同样是 REST 的接口，那么就需要把 <code>user</code> 和 <code>article</code> 全部返回，这样的话就需要把 <code>CommentDatafetcher</code> 和 <code>UserDatafetcher</code> 的工作全部放到 <code>QueryService</code> 中去。但是 GraphQL 则像是在按需获取：如果你要了 <code>comments</code> 就会调用 <code>CommentDatafetcher.fetchComments</code> 否则就不会执行。这样子就让上文中那种 <code>user.getSubscriptions().subList(from, from + pageSize)</code> 的方式变得更加的顺理成章了。</p>
<h3 id="抽取公共逻辑" style="position:relative;">抽取公共逻辑<a href="#%E6%8A%BD%E5%8F%96%E5%85%AC%E5%85%B1%E9%80%BB%E8%BE%91" aria-label="抽取公共逻辑 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>刚好最近 ddd/cqrs 的 google group 也在讨论这个主题 <a href="https://groups.google.com/g/dddcqrs/c/d7aiKi6ha6g">Read model business logic duplication</a>。这里给出的方案也非常简单：</p>
<ol>
<li>如果这种权限展示逻辑只在 read model 里，那干脆就放 read model 好了，没什么大不了</li>
<li>如果两边都出现了，那就抽取 Speicification 让两边共享</li>
<li>对于一些场景，可以让 write model 直接去调用 read model 使用其内容</li>
</ol>
<p>打补丁自然是简单不少，不过总感觉不是那么舒服...这部分我也就只能写到这里了，虽然写的不多，可却是花了不少时间去想这坨东西...现在回看目前 openbayes 的代码还是有不少的问题，后续再继续理一理吧。</p></div></div><div><h1><a href="/gatsby-plugins-for-blog">gatsby 一些插件的运用</a></h1><h2>2021 August-14</h2><div class="prose dark:prose-dark max-w-none lg:prose-lg xl:prose-xl"><p><a href="/blog-migrate-from-jekyll-to-gatsby">上一篇文章</a> 介绍了 gatsby 迁移 blog 的主要内容，针对 markdown 渲染、路由生成 gatsby 都做了足够多的工作可以快速构建这么一个博客系统。这一部分介绍通过额外的插件提升 blog 体验。</p>
<h2 id="目录--标题锚点" style="position:relative;">目录 &#x26; 标题锚点<a href="#%E7%9B%AE%E5%BD%95--%E6%A0%87%E9%A2%98%E9%94%9A%E7%82%B9" aria-label="目录  标题锚点 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>通过 remark 获取的 markdown 内容本身一个名为 <code>tableOfContents</code> 的部分，它已经从 markdown 中提取了标题并生成了目录。额外的工作就只剩下对目录的样式做一些修改，并且添加锚点链接。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/676aa689526b675fb1b9febeb5cc2609/6bff2/2021-08-14-15-17-25.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABAklEQVQY023L3U6DMACGYe7/hkwmWaZkuvGzJZDRguKGLAz6A6O0trQyFo0HavbkS76j1yqKY1mWVXXCGCOEMcYEE4QQIeRUVQhhShtCv/0cpQ2talTVyGLn7tx2ctDamM9fxnFUSvVCMCEY/+AdF0xwxnn3NSFkx3pLSdl24q2oacumv7Q2tEQ53Md+nATgECb5Bh6iNE+y933OWG9JKbUxpOVK6X+x0fp1HcZ3T2C2AnMX2GtwvwaPPlwG4HlLSWNxzsdxnG4xWmerEMxdaHtw5ia2Bxc+dALgBC9uWBRHaxjUNE2Xy63YmCzYgYUHnU3yECTLbeqGqR+lEUh3sKHtFaEOSgr4uB6QAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="2021 08 14 15 17 25"
        title="2021 08 14 15 17 25"
        src="/static/676aa689526b675fb1b9febeb5cc2609/5a190/2021-08-14-15-17-25.png"
        srcset="/static/676aa689526b675fb1b9febeb5cc2609/772e8/2021-08-14-15-17-25.png 200w,
/static/676aa689526b675fb1b9febeb5cc2609/e17e5/2021-08-14-15-17-25.png 400w,
/static/676aa689526b675fb1b9febeb5cc2609/5a190/2021-08-14-15-17-25.png 800w,
/static/676aa689526b675fb1b9febeb5cc2609/6bff2/2021-08-14-15-17-25.png 957w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>锚点部分同样有另外一个插件 <a href="https://www.gatsbyjs.com/plugins/gatsby-remark-autolink-headers/">gatsby-remark-autolink-headers
</a> 完成了相应的工作。它本身就是 <code>gatsby-transformer-remark</code> 的一个插件。通过做如下配置即可：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span> 
    resolve<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">gatsby-remark-autolink-headers</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
        offsetY<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">100</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20">&lt;path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">&lt;/path>&lt;/svg></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        className<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">custom-class</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        maintainCase<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        removeAccents<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        isIconAfterHeader<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<p>注意要把 <code>maintainCase</code> 设置为 <code>false</code> 否则会因为锚点的大小写问题导致链接失效，完整的配置在 <a href="https://github.com/aisensiy/aisensiy.github.com/blob/master/gatsby-config.js">gatsby-config.js</a> 可以看到。</p>
<p>插件生效后目录以及 markdown 的标题（<code>#</code> 开始的内容）就会增加链接并支持从目录跳转了。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/36ec595f991d81b6848ac7b6e973873c/e8e04/2021-08-14-15-25-00.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABAUlEQVQY022O20rDQBBA8///oT9QUXzUD7AqKKI1TdOmZpNNupvO3mayM1K8gODhvB44Ra/HZt+2qt+3nZ2O8sPBmFEPWls7BQAfHHgHiIh0kohiSsV2u1ut3pVS+6ax1vzGxlo4WKvNZFMKIUX0Hr0nopyz5Mycuegmfuvmtc614fUoxn/HAEBEzk7WAkzROXQOU5oRM9HJmebirgrnt81iaa6f4tVzrkcWEWYhIhYBe9T9YA6QM8tfmLm436Szm+ZiOV0+wuIh1GP+ihFRRDCedkWy/AMXyuDLDkqVShVfP0JvAmIiIh9Re+5hXqtQDbka5mqYS+XKFjY61kNqDH0CdZ9VdbtXyGgAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="2021 08 14 15 25 00"
        title="2021 08 14 15 25 00"
        src="/static/36ec595f991d81b6848ac7b6e973873c/5a190/2021-08-14-15-25-00.png"
        srcset="/static/36ec595f991d81b6848ac7b6e973873c/772e8/2021-08-14-15-25-00.png 200w,
/static/36ec595f991d81b6848ac7b6e973873c/e17e5/2021-08-14-15-25-00.png 400w,
/static/36ec595f991d81b6848ac7b6e973873c/5a190/2021-08-14-15-25-00.png 800w,
/static/36ec595f991d81b6848ac7b6e973873c/c1b63/2021-08-14-15-25-00.png 1200w,
/static/36ec595f991d81b6848ac7b6e973873c/e8e04/2021-08-14-15-25-00.png 1270w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<h2 id="seo-优化" style="position:relative;">SEO 优化<a href="#seo-%E4%BC%98%E5%8C%96" aria-label="seo 优化 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>这部分在国内似乎略微鸡肋，毕竟整个体系是 Google 提供的，不过我相信这部分的工作还是有必要的，因为众所周知，靠谱的程序员还是会倾向于使用英语环境并使用 Google 搜索资料。还有一个让我很震惊的地方，就是 Google Analytics 其实并没有被墙，域名是可以访问的，只是查看的 dashboard 无法直接访问。</p>
<p>这部分基本就是照抄 <a href="https://www.gatsbyjs.com/docs/add-seo-component/">Add SEO Component</a> 了，用到的插件就是 <code>gatsby-plugin-react-helmet</code>。组件的代码就直接贴在这里了：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Helmet <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-helmet"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useLocation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@reach/router"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useStaticQuery<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">SEO</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> title<span class="token punctuation">,</span> description<span class="token punctuation">,</span> image<span class="token punctuation">,</span> article <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pathname <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> site <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useStaticQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    defaultTitle<span class="token punctuation">,</span>
    titleTemplate<span class="token punctuation">,</span>
    defaultDescription<span class="token punctuation">,</span>
    siteUrl<span class="token punctuation">,</span>
    defaultImage<span class="token punctuation">,</span>
    twitterUsername<span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token operator">=</span> site<span class="token punctuation">.</span>siteMetadata<span class="token punctuation">;</span>
  <span class="token keyword">const</span> seo <span class="token operator">=</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> title <span class="token operator">||</span> defaultTitle<span class="token punctuation">,</span>
    description<span class="token operator">:</span> description <span class="token operator">||</span> defaultDescription<span class="token punctuation">,</span>
    image<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>siteUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>image <span class="token operator">||</span> defaultImage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>siteUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pathname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Helmet title<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>title<span class="token punctuation">}</span> titleTemplate<span class="token operator">=</span><span class="token punctuation">{</span>titleTemplate<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"description"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>description<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"image"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>image<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span>seo<span class="token punctuation">.</span>url <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>meta property<span class="token operator">=</span><span class="token string">"og:url"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>url<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token punctuation">(</span>article <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>meta property<span class="token operator">=</span><span class="token string">"og:type"</span> content<span class="token operator">=</span><span class="token string">"article"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>seo<span class="token punctuation">.</span>title <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>meta property<span class="token operator">=</span><span class="token string">"og:title"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>title<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>seo<span class="token punctuation">.</span>description <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>meta property<span class="token operator">=</span><span class="token string">"og:description"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>description<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>seo<span class="token punctuation">.</span>image <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>meta property<span class="token operator">=</span><span class="token string">"og:image"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>image<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"twitter:card"</span> content<span class="token operator">=</span><span class="token string">"summary_large_image"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span>twitterUsername <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"twitter:creator"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>twitterUsername<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>seo<span class="token punctuation">.</span>title <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"twitter:title"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>title<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>seo<span class="token punctuation">.</span>description <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"twitter:description"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>description<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>seo<span class="token punctuation">.</span>image <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"twitter:image"</span> content<span class="token operator">=</span><span class="token punctuation">{</span>seo<span class="token punctuation">.</span>image<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Helmet<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token constant">SEO</span><span class="token punctuation">;</span>

<span class="token constant">SEO</span><span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span>
  description<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span>
  image<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span>
  article<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>bool<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token constant">SEO</span><span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  image<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  article<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> graphql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query SEO {
    site {
      siteMetadata {
        defaultTitle: title
        titleTemplate
        defaultDescription: description
        siteUrl: url
        defaultImage: image
        twitterUsername
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span></code></pre></div>
<p>然后在 <code>blog</code> 的模板这里做一些修改：</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> graphql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span>
<span class="token keyword">import</span> Blog <span class="token keyword">from</span> <span class="token string">"../components/Blog"</span>
<span class="token keyword">import</span> Base <span class="token keyword">from</span> <span class="token string">"../layouts/base"</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">import</span> Seo <span class="token keyword">from</span> <span class="token string">"../components/seo"</span></span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">BlogTemplate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Base<span class="token operator">></span>
<span class="gatsby-highlight-code-line">      <span class="token operator">&lt;</span>Seo title<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token punctuation">}</span> article<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> description<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>excerpt<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></span>      <span class="token operator">&lt;</span>Blog data<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>blog<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Base<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>这里使用了 <code>excerpt</code> 字段，当然在 graphql 里面也要增加相应的内容：</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="graphql"><pre class="language-graphql"><code class="language-graphql"><span class="token property">export</span> <span class="token property">const</span> <span class="token property">pageQuery</span> <span class="token operator">=</span> <span class="token property">graphql</span>`
  <span class="token keyword">query</span> <span class="token definition-query function">BlogPostQuery</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token attr-name">blog</span><span class="token punctuation">:</span> <span class="token property-query">markdownRemark</span><span class="token punctuation">(</span><span class="token attr-name">id</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token attr-name">eq</span><span class="token punctuation">:</span> <span class="token variable">$id</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token property">id</span>
      <span class="token property">html</span>
      <span class="token property">tableOfContents</span>
      <span class="token object">frontmatter</span> <span class="token punctuation">{</span>
        <span class="token property">title</span>
        <span class="token property-query">date</span><span class="token punctuation">(</span><span class="token attr-name">formatString</span><span class="token punctuation">:</span> <span class="token string">"MMMM DD, YYYY"</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
<span class="gatsby-highlight-code-line">      <span class="token property-query">excerpt</span><span class="token punctuation">(</span><span class="token attr-name">format</span><span class="token punctuation">:</span> <span class="token constant">PLAIN</span><span class="token punctuation">,</span> <span class="token attr-name">truncate</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token attr-name">pruneLength</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">)</span></span>    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
`</code></pre></div></div></div><div><h1><a href="/tailwindcss-get-started">初识 tailwindcss</a></h1><h2>2021 July-27</h2><div class="prose dark:prose-dark max-w-none lg:prose-lg xl:prose-xl"><p>在 <a href="/blog-migrate-from-jekyll-to-gatsby">上一篇文章</a> 中提到了已经在自己的新博客中集成了 tailwindcss 。这篇对这个思路不太一样的 css 框架做一些介绍。</p>
<h2 id="核心思想" style="position:relative;">核心思想<a href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3" aria-label="核心思想 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>用过 bootstrap 的人都晓得，bootstrap 提供了如下内容：</p>
<ol>
<li>一套默认的样式，比如 <code>h1</code> 长什么样 <code>button.btn</code> 长什么样</li>
<li>一套布局系统，默认 12 列，实现各种宽度组合</li>
<li>一套通用组件库，比如面包屑，比如下拉菜单</li>
</ol>
<p>和 bootstrap 体系几乎一样的东西还很多，比如当年雅虎的 <a href="https://purecss.io/start/">purecss</a>。</p>
<p>相比于 bootstrap 这种被大家所广泛认知的 css 框架，tailwindcss 有如下差别：</p>
<ol>
<li>
<p>没有默认样式，单有一套 reset 样式，将所有的东西设置为一样的大小，比如 <code>h1</code> <code>h2</code> <code>p</code> 的字号、颜色都一样</p>
</li>
<li>
<p><strong>所有的</strong> css 样式完全通过一系列工具类（utility classes）组合实现，比如一个 <code>button</code> 可以这么实现：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rounded-md shadow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>w-full flex items-center justify-center
                      px-8 py-3 border border-transparent
                      text-base font-medium rounded-md 
                      text-white bg-indigo-600 hover:bg-indigo-700 md:py-4 md:text-lg
                      md:px-10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    Get started
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<p>结果如下：</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 214px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1043675ef3ac07d2de7589612fa6067d/a48b3/2021-07-27-20-05-13.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVQoz62S20obURSG80wFaURTNWPUxEPiATyBRbRqPGEQQbEaxMOFCj6CF32IKqGX7X19AZPM7MyMF1YFYyaZ+MmaSYjSi4KUzbf/Wf/e87OGWQGnXKHk/B+cskug5LhUn9+PK4pLxXW90AC4fDu/Zf6zRSpps7bQoF6LpuqatP+6t/LF4ur3I5LlBX7dsAh9yNPbbtAT0om06GjNOuFg7Tmo0yn1R9/Xan70k0GszaC9Sefy+x1Q9QMPdm7oDhkMRxVDPYrVOZO1BcFierRAKmmxOG2yvmSyPFPwzuanCvRripGY8kJ/ZO4bgfs7Nl2tOkNRxWC3YmPV5PTIJr1pszJrsbdtc7hrkd40PU4OxS/Q2+E3IZ2+CUxv2WhBg0SXoj+s6Asr7/MF6UJeFF866etQPmHFgKaIRxSRFoPMxavAs+Mb4pE8k4MG4/EaCZ+xWj1W9+JvmUgYDMd0fv188H9KueJy+8che/1ILlckly36+i+yDc3nixSf/FkMyCYz9Ez13ciSoZbBfgGPeYS53SLSWAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="2021 07 27 20 05 13"
        title="2021 07 27 20 05 13"
        src="/static/1043675ef3ac07d2de7589612fa6067d/a48b3/2021-07-27-20-05-13.png"
        srcset="/static/1043675ef3ac07d2de7589612fa6067d/772e8/2021-07-27-20-05-13.png 200w,
/static/1043675ef3ac07d2de7589612fa6067d/a48b3/2021-07-27-20-05-13.png 214w"
        sizes="(max-width: 214px) 100vw, 214px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
</li>
<li>
<p>默认没有提供通用组建库，不过这部分我认为更多还是一个商业上的考虑</p>
</li>
</ol>
<p>其中第二条算是 tailwindcss 最大的特色了，虽然 bootstrap 也包含很多工具类，但 bootstrap 的工具类并不是可以解决所有问题的，仅仅是一个辅助措施。而在 tailwindcss， 工具类就是实现 html 完整样式的最小单元。</p>
<p>全部通过类组合类拼凑样式看起来有点丑陋，以及它违反了 html 语义化的原则。不过 tailwindcss 的作者撰写了 <a href="https://adamwathan.me/css-utility-classes-and-separation-of-concerns/">一篇文章</a> 对这部分困惑做了很详尽的说明。我非常推荐直接阅读原文并阅读文中引用的另外一篇文章：<a href="http://nicolasgallagher.com/about-html-semantics-front-end-architecture/">About HTML semantics and front-end architecture</a>。这里我把我理解的一些重要观点放在这里，这也是我认可 tailwindcss 并开始使用的原因。</p>
<ol>
<li>
<p>语义实际上是让 css 依赖 html。在 html 结构需要扩展的时候，css 必须随之变化，而 html 确实经常变化，所以并没有省什么事</p>
</li>
<li>
<p>原本的语义化思路有点问题，一个名为 <code>author</code> 的 <code>class</code> 真的有意义么？从实际角度出发， <code>class</code> 是给 <code>css</code> 用的而 <code>css</code> 关心的是样式，所以 <code>class</code> 改成 <code>media-card</code> 更合理，也就是说语义化面向的应该是 css 而不是 html 里的内容</p>
</li>
<li>
<p>语义化是让 css 依赖 html 那么可不可以反过来，让 html 依赖 css？从文章 <a href="http://nicolasgallagher.com/about-html-semantics-front-end-architecture/">About HTML semantics and front-end architecture</a> 获得灵感，确定反过来反而更有效：</p>
<blockquote>
<p>When you choose to author HTML and CSS in a way that seeks to reduce the amount of time you spend writing and editing CSS, it involves accepting that you must instead spend more time changing HTML classes on elements if you want to change their styles. This turns out to be fairly practical, both for front-end and back-end developers – anyone can rearrange pre-built “lego blocks”; it turns out that no one can perform CSS-alchemy.</p>
</blockquote>
<p>这里简单翻译一下：</p>
<blockquote>
<p>如果你试图找到一种方法来减少花费在 css 上的时间，那么你就必然会花费更多时间在 html 上。不过这种结果是更易于实施的：不论是前端工程师或是后端工程师，都更易于修改这些预定义的 "乐高积木"，但没人是 CSS 炼金术师（轻松驾驭编辑 CSS 代码）。</p>
</blockquote>
</li>
<li>
<p>相对于 bootstrap 更细粒度的工具类给了用户更大的自由度，可以完全脱离手写 css 而构建复杂的样式，不必再为扩展基本样式而担忧了</p>
</li>
<li>
<p>之所以反对手写 css （inline style 或者类似于 styled component）是因为它会带来大量的碎片化样式，通过 tailwindcss 可以避免样式的泛滥（比如有太多种字号大小）</p>
</li>
</ol>
<h2 id="入门资料" style="position:relative;">入门资料<a href="#%E5%85%A5%E9%97%A8%E8%B5%84%E6%96%99" aria-label="入门资料 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>tailwindcss 的 youtube 频道里视频教程做的太好了。请把 <a href="https://www.youtube.com/playlist?list=PL5f_mz_zU5eXWYDXHUDOLBE0scnuJofO0">Tailwind CSS: From Zero to Production</a> 这个系列一口气全部看完，你就可以掌握 tailwindcss 的基本用法了。</p>
<p>看了之后你大概可以收获这些内容：</p>
<ol>
<li>tailwindcss 类的命名规律，你就不会太害怕自己记不住了</li>
<li>配合使用的一些列工具是什么，比如 vscode 插件</li>
<li>tailwindcss 怎么做响应式设计</li>
<li>怎么扩展 tailwindcss</li>
<li>怎么使用 purgecss 对 css 文件进行压缩</li>
</ol>
<h2 id="目前的博客是如何使用-tailwindcss-的" style="position:relative;">目前的博客是如何使用 tailwindcss 的<a href="#%E7%9B%AE%E5%89%8D%E7%9A%84%E5%8D%9A%E5%AE%A2%E6%98%AF%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-tailwindcss-%E7%9A%84" aria-label="目前的博客是如何使用 tailwindcss 的 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>博客的情况其实反而有点不太适合 tailwindcss 的场景，因为博客里面的 markdown 是需要从外部注入样式的，而不是像 tailwindcss 推荐的那样去对每个元素添加工具类。官方也有一篇视频 <a href="https://www.youtube.com/watch?v=J0Wy359NJPM">Styling Markdown and CMS Content with Tailwind CSS</a> 介绍如何处理，这里我使用了官方的方式并且按照 <a href="https://sergiodxa.com/articles/use-tailwindcss-typography-with-dark-mode-styles">Use TailwindCSS Typography with Dark Mode Styles</a> 增加了 dark mode 的支持。</p>
<p>然后就是在 <code>global.css</code> 多了些修修补补的支持：</p>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@tailwind</span> base<span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@tailwind</span> components<span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@tailwind</span> utilities<span class="token punctuation">;</span></span>

<span class="token atrule"><span class="token rule">@layer</span> components</span> <span class="token punctuation">{</span>
    <span class="token selector">body</span> <span class="token punctuation">{</span>
        <span class="token atrule"><span class="token rule">@apply</span> bg-white <span class="token property">dark</span><span class="token punctuation">:</span>bg-gray-700 transition duration-500<span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
    <span class="token selector">.main .permalink</span> <span class="token punctuation">{</span>
        <span class="token atrule"><span class="token rule">@apply</span> fill-current text-gray-800 <span class="token property">dark</span><span class="token punctuation">:</span>text-gray-200<span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
    <span class="token selector">.main</span> <span class="token punctuation">{</span>
        <span class="token atrule"><span class="token rule">@apply</span> text-gray-800 <span class="token property">dark</span><span class="token punctuation">:</span>text-gray-200<span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
    <span class="token selector">.main h1</span> <span class="token punctuation">{</span>
        <span class="token atrule"><span class="token rule">@apply</span> text-3xl <span class="token property">md</span><span class="token punctuation">:</span>text-4xl font-extrabold tracking-tight my-4<span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
    <span class="token selector">.main h2</span> <span class="token punctuation">{</span>
        <span class="token atrule"><span class="token rule">@apply</span> mb-4 text-gray-600 <span class="token property">dark</span><span class="token punctuation">:</span>text-gray-300<span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
    <span class="token selector">.main</span> <span class="token punctuation">{</span>
        <span class="token atrule"><span class="token rule">@apply</span> break-words<span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>可以看到，响应式的支持和 dark mode 的支持都在里面了。</p>
<h2 id="小结" style="position:relative;">小结<a href="#%E5%B0%8F%E7%BB%93" aria-label="小结 permalink" class="custom-class after"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>我认为它在两个方面的工作是非常有意义的：</p>
<ol>
<li>将 html 和 css 的依赖反转是正确的。事实上由于业务的变化，展示信息的变化，html 的变化速度是很快的，每次让 css 被动变更确实会导致额外的工作量。中立的细粒度的 css 一定程度上会有所帮助</li>
<li>直接在 class 上增增减减就能实现排版从认知上确实让人觉得容易了，而且有了 <code>STATE VARIANTS</code> （就是 <code>focus:</code> <code>hover:</code> <code>md:</code> 这样的前缀工具类）确实让 css 的工作变得更集中更清楚了，比一个独立的文件以及松散的排布要好</li>
</ol>
<p>tailwindcss 似乎在尝试将 css 乐高化以进一步降低前端工程师的门槛。但我觉得这个乐高依然是有门槛的，如果你甚至不晓得 <code>flex</code> <code>display</code> <code>position</code> <code>float</code> 这些基本的概念，那么你依然没办法去使用这些工具类。</p></div></div><div class="flex justify-center mt-8"><a class="w-32 text-center px-4 py-1 border mx-4 border-gray-800 border-solid" href="/page/3">Previous</a><a class="w-32 text-center px-4 py-1 border mx-4 border-gray-800 border-solid" href="/page/5">Next</a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-31932181-2"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-31932181-2', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/page/4";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-a5c447d830ba27eaafd9.js"],"app":["/app-301092c0672bcce1568f.js"],"component---src-pages-404-js":["/component---src-pages-404-js-905556e6cc2f6ac9ed64.js"],"component---src-pages-about-js":["/component---src-pages-about-js-3e44f50e14eb9752ba70.js"],"component---src-pages-archive-js":["/component---src-pages-archive-js-5445ee8c0a296a4bd4fe.js"],"component---src-pages-index-js":["/component---src-pages-index-js-89872398fa54d7dfa02e.js"],"component---src-templates-blog-js":["/component---src-templates-blog-js-f8b3cfd953e4be9c4cbc.js"],"component---src-templates-blogs-js":["/component---src-templates-blogs-js-57b56258f6f79ef8dfb6.js"]};/*]]>*/</script><script src="/polyfill-a5c447d830ba27eaafd9.js" nomodule=""></script><script src="/component---src-templates-blogs-js-57b56258f6f79ef8dfb6.js" async=""></script><script src="/75ce8a9e25edca21eb9c1a1dab0250d3ee550bef-e9b300a9f21137291b3a.js" async=""></script><script src="/app-301092c0672bcce1568f.js" async=""></script><script src="/framework-45ca7a0c983b0b7a000c.js" async=""></script><script src="/webpack-runtime-18a31e4fa83bf1e38b67.js" async=""></script></body></html>